<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand -->
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="SpaTopic">
  <title>Spatial expansion • SpaTopic</title>
  <script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
  <script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
    integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css"
    integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
  <!-- bootstrap-toc -->
  <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js"
    integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script>
  <!-- headroom.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js"
    integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js"
    integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>
  <!-- clipboard.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"
    integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js"
    integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A=="
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js"
    integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg=="
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js"
    integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww=="
    crossorigin="anonymous"></script><!-- pkgdown -->
  <script src="../pkgdown.js"></script>
  <meta property="og:title" content="Spatial expansion">
  <meta property="og:description" content="SpaTopic">
  <!-- mathjax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"
    integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js"
    integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>

<body>
  <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


  <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light">
    <div class="container">

      <a class="navbar-brand me-2" href="../index.html">SpaTopic</a>

      <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom"
        title="">0.1.0</small>


      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar"
        aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div id="navbar" class="collapse navbar-collapse ms-3">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <a class="nav-link" href="../reference/index.html">Reference</a>
          </li>
          <li class="active nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false"
              aria-haspopup="true" id="dropdown-articles">Articles</a>
            <div class="dropdown-menu" aria-labelledby="dropdown-articles">
              <a class="dropdown-item" href="../articles/CellTopic_analysis.html">CellTopic analysis</a>
              <a class="dropdown-item" href="../articles/Quick_start.html">Quick start</a>
              <a class="dropdown-item" href="../articles/Spatial_expansion.html">Spatial expansion</a>
              <a class="dropdown-item" href="../articles/SpaTopic_workflow.html">SpaTopic workflow</a>
            </div>
          </li>
        </ul>
        <form class="form-inline my-2 my-lg-0" role="search">
          <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input"
            data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
        </form>

        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="external-link nav-link" href="https://github.com/compbioNJU/SpaTopic/" aria-label="github">
              <span class="fab fa fab fa-github fa-lg"></span>

            </a>
          </li>
        </ul>
      </div>


    </div>
  </nav>
  <div class="container template-article">




    <div class="row">
      <main id="main" class="col-md-9">
        <div class="page-header">
          <img src="" class="logo" alt="">
          <h1>Spatial expansion</h1>


          <small class="dont-index">Source: <a
              href="https://github.com/compbioNJU/SpaTopic/blob/HEAD/vignettes/Spatial_expansion.Rmd"
              class="external-link"><code>vignettes/Spatial_expansion.Rmd</code></a></small>
          <div class="d-none name"><code>Spatial_expansion.Rmd</code></div>
        </div>



        <div class="sourceCode" id="cb1">
          <pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/compbioNJU/SpaTopic" class="external-link">SpaTopic</a></span><span class="op">)</span></span></code></pre>
        </div>
        <div class="section level2">
          <h2 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
          </h2>
          <div class="sourceCode" id="cb2">
            <pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#66b803"</span>, <span class="st">"#E5AA9B"</span>, <span class="st">"#FABD3E"</span>, <span class="st">"#2B8CBE"</span>, <span class="st">"#DE77AE"</span>, <span class="st">"#9970AB"</span>, <span class="st">"gray"</span>, <span class="st">"#D5E4A2"</span>, <span class="st">"#71D0F5"</span>, <span class="st">"#B1746F"</span>, <span class="st">"#ADE2D0"</span>, <span class="st">"#20DE8BFF"</span>, <span class="st">"#CCDE8BFF"</span>, <span class="st">"#FFDE8BFF"</span>, <span class="st">"#FFA88BFF"</span>, <span class="st">"#FF6A8BFF"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"vignette_data/HCC_1L_obj.rda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"vignette_data/HCC_1L_spot_celltype.rda"</span><span class="op">)</span></span></code></pre>
          </div>
          <p>
            The “HCC_1L_obj.rda” comes from <a href="https://www.science.org/doi/10.1126/sciadv.abg3750"
              class="uri">https://www.science.org/doi/10.1126/sciadv.abg3750</a>.
          </p>
        </div>
        <div class="section level2">
          <h2 id="spatopic">SpaTopic<a class="anchor" aria-label="anchor" href="#spatopic"></a>
          </h2>
          <p>We first use SpaTopic to get the CellTopic of the spatial domain.</p>
          <div class="sourceCode" id="cb3">
            <pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HCC_1L_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html" class="external-link">RunPCA</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>, assay <span class="op">=</span> <span class="st">"SCT"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">HCC_1L_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>, reduction <span class="op">=</span> <span class="st">"pca"</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">HCC_1L_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">FindClusters</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>, resolution <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">HCC_1L_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunUMAP.html" class="external-link">RunUMAP</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>, reduction <span class="op">=</span> <span class="st">"pca"</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">HCC_1L_spot_clusters</span> <span class="op">&lt;-</span> <span class="va">HCC_1L_obj</span><span class="op">@</span><span class="va">meta.data</span><span class="op">[</span><span class="st">"seurat_clusters"</span><span class="op">]</span></span>
<span><span class="va">result_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CellTopic.html">CellTopic</a></span><span class="op">(</span></span>
<span>  <span class="va">HCC_1L_spot_celltype</span>,</span>
<span>  <span class="va">HCC_1L_spot_clusters</span>,</span>
<span>  cluster <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>  num_topics <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  percent <span class="op">=</span> <span class="fl">0.7</span></span>
<span><span class="op">)</span></span>
<span><span class="va">HCC_1L_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/AddMetaData.html" class="external-link">AddMetaData</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>, <span class="va">result_list</span><span class="op">[[</span><span class="st">"CellTopic"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialDimPlot</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>, group.by <span class="op">=</span> <span class="st">"CellTopic"</span>, image.alpha <span class="op">=</span> <span class="fl">0</span>, pt.size.factor <span class="op">=</span> <span class="fl">2.2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">my_colors</span><span class="op">)</span></span></code></pre>
          </div>
          <p><img src="Spatial_expansion_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
          <pre><code>Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck

Number of nodes: 2791
Number of edges: 103726

Running Louvain algorithm...
Maximum modularity in 10 random starts: 0.7420
Number of communities: 16
Elapsed time: 0 seconds</code></pre>
        </div>
        <div class="section level2">
          <h2 id="spatial-expansion">Spatial expansion<a class="anchor" aria-label="anchor"
              href="#spatial-expansion"></a>
          </h2>
          <p><code>Spatial_expansion</code> then divides buffers and angles for
            the specified spatial domain. It is worth noting that this method is not
            only applicable to SpaTopic, but also to arbitrary spatial partitions
            with certain continuity.</p>
          <p>We divide the buffers and angles of the spatial domain of the tumor
            boundary by specifying CellTopic column in
            <code>Seurat@meta.data</code>, and CellTopic8 in it.
          </p>
          <div class="sourceCode" id="cb5">
            <pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HCC_1L_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Spatial_expansion.html">Spatial_expansion</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>,</span>
<span>    CellTopic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CellTopic8"</span><span class="op">)</span>,</span>
<span>    meta.col <span class="op">=</span> <span class="st">"CellTopic"</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"Hexagon"</span>,</span>
<span>    edge.plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>
          </div>
          <p><img src="Spatial_expansion_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
          <pre><code>Use the low resolution image
The type of data is Hexagon 
The alpha value of alpha-shape method is 232 
The distance of expansion is 200 
The expansion of the data is added to the Seurat@meta.data and the message is added to Seurat@misc</code></pre>
          <p>When set <code>edge.plot = TRUE</code>, the function draw a reference
            plot representing the specified spatial domain divide. We can obtain a
            more appropriate spatial domain divide by modifying the alpha parameter
            of alpha-shape calculation.</p>
          <p>We can check the relevant parameter settings in
            <code>Seurat@misc</code> as a reference for our adjustments
          </p>
          <div class="sourceCode" id="cb7">
            <pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HCC_1L_obj</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">expansion</span><span class="op">$</span><span class="va">CellTopic8</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre>
          </div>
          <pre><code>$distance
[1] 200

$alpha
[1] 232

$type
[1] "Hexagon"

$image
[1] "lowres"

$image.factor
[1] 0.02920561</code></pre>
          <p>Here we get a more appropriate spatial domain divide by setting
            <code>alpha = 280</code>.
          </p>
          <div class="sourceCode" id="cb9">
            <pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HCC_1L_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Spatial_expansion.html">Spatial_expansion</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>,</span>
<span>    CellTopic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CellTopic8"</span><span class="op">)</span>,</span>
<span>    meta.col <span class="op">=</span> <span class="st">"CellTopic"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">280</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"Hexagon"</span>,</span>
<span>    edge.plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>
          </div>
          <p><img src="Spatial_expansion_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
          <pre><code>Use the low resolution image
The type of data is Hexagon 
The alpha value of alpha-shape method is 280 
The distance of expansion is 200 
The expansion of the data is added to the Seurat@meta.data and the message is added to Seurat@misc</code></pre>
          <p>We can use <code>SpatialFeaturePlot</code> in Seurat to show buffer
            divide of spatial domain.</p>
          <div class="sourceCode" id="cb11">
            <pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>, features <span class="op">=</span> <span class="st">"expansion_CellTopic8"</span>, pt.size.factor <span class="op">=</span> <span class="fl">2.2</span><span class="op">)</span></span></code></pre>
          </div>
          <p><img src="Spatial_expansion_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
          <p>On the other hand, you can increase or decrease the width of the
            buffers by setting <code>distance</code> .</p>
          <div class="sourceCode" id="cb12">
            <pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HCC_1L_obj_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Spatial_expansion.html">Spatial_expansion</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>,</span>
<span>    CellTopic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CellTopic8"</span><span class="op">)</span>,</span>
<span>    meta.col <span class="op">=</span> <span class="st">"CellTopic"</span>,</span>
<span>    distance <span class="op">=</span> <span class="fl">800</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">280</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"Hexagon"</span>,</span>
<span>    edge.plot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">HCC_1L_obj_1</span>, features <span class="op">=</span> <span class="st">"expansion_CellTopic8"</span>, pt.size.factor <span class="op">=</span> <span class="fl">2.2</span><span class="op">)</span></span></code></pre>
          </div>
          <p><img src="Spatial_expansion_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
          <pre><code>Use the low resolution image
The type of data is Hexagon 
The alpha value of alpha-shape method is 280 
The distance of expansion is 800 
The expansion of the data is added to the Seurat@meta.data and the message is added to Seurat@misc</code></pre>
          <div class="section level3">
            <h3 id="angle">Angle<a class="anchor" aria-label="anchor" href="#angle"></a>
            </h3>
            <p><code>Spatial_expansion</code> creates not only buffer information in
              Seurat@meta.data, but also angle information.</p>
            <p>We regard the geometric center of a spatial domain as the center, and
              the left side of the spatial domain is the starting point and the ending
              point of the circle.</p>
            <div class="sourceCode" id="cb14">
              <pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialFeaturePlot</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>, features <span class="op">=</span> <span class="st">"angle_CellTopic8"</span>, pt.size.factor <span class="op">=</span> <span class="fl">2.2</span><span class="op">)</span></span></code></pre>
            </div>
            <p><img src="Spatial_expansion_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
          </div>
        </div>
        <div class="section level2">
          <h2 id="gene-plot">Gene plot<a class="anchor" aria-label="anchor" href="#gene-plot"></a>
          </h2>
          <p>After dividing the spatial domain we can use
            <code>Expansion_gene_plot</code> to show gene expression changes in
            buffers in different angles.
          </p>
          <p>Here we set <code>angle = 90</code>, <code>parts = 2</code> to get
            gene expression on both sides of the tumor boundary.</p>
          <div class="sourceCode" id="cb15">
            <pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Expansion_gene_plot.html">Expansion_gene_plot</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>,</span>
<span>    CellTopic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CellTopic8"</span><span class="op">)</span>,</span>
<span>    gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ACTA2"</span>, <span class="st">"C11orf96"</span>, <span class="st">"CALD1"</span>, <span class="st">"COL1A2"</span>, <span class="st">"CSRP1"</span>, <span class="st">"CTGF"</span>, <span class="st">"FLNA"</span>, <span class="st">"IGFBP7"</span>, <span class="st">"MYH11"</span>, <span class="st">"MYL9"</span>, <span class="st">"PPP1R14A"</span>, <span class="st">"TAGLN"</span>, <span class="st">"TPM2"</span><span class="op">)</span>,</span>
<span>    meta.col <span class="op">=</span> <span class="st">"CellTopic"</span>, angle <span class="op">=</span> <span class="fl">90</span>, parts <span class="op">=</span> <span class="fl">2</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, cols <span class="op">=</span> <span class="va">my_colors</span></span>
<span><span class="op">)</span></span></code></pre>
          </div>
          <p><img src="Spatial_expansion_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
          <p>This method was consistent across different angles, as shown when
            dividing the spatial domain into four sections starting at 50
            degrees.</p>
          <div class="sourceCode" id="cb16">
            <pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Expansion_gene_plot.html">Expansion_gene_plot</a></span><span class="op">(</span><span class="va">HCC_1L_obj</span>,</span>
<span>    CellTopic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CellTopic8"</span><span class="op">)</span>,</span>
<span>    gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ACTA2"</span>, <span class="st">"C11orf96"</span>, <span class="st">"COL1A2"</span>, <span class="st">"CSRP1"</span><span class="op">)</span>,</span>
<span>    meta.col <span class="op">=</span> <span class="st">"CellTopic"</span>, angle <span class="op">=</span> <span class="fl">50</span>, parts <span class="op">=</span> <span class="fl">4</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, cols <span class="op">=</span> <span class="va">my_colors</span></span>
<span><span class="op">)</span></span></code></pre>
          </div>
          <p><img src="Spatial_expansion_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
          <p>If you need to plot data for further analysis or re-plotting, you can
            set <code>plot = FALSE</code> to obtain the expression of genes in
            buffers at different angles.</p>
        </div>
      </main>
      <aside class="col-md-3">
        <nav id="toc">
          <h2>On this page</h2>
        </nav>
      </aside>
    </div>



    <footer>
      <div class="pkgdown-footer-left">
        <p></p>
        <p>Developed by Yuelei Zhang.</p>
      </div>

      <div class="pkgdown-footer-right">
        <p></p>
        <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
      </div>

    </footer>
  </div>





</body>

</html>